(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{34226:function(t,e,n){Promise.resolve().then(n.bind(n,66374))},89318:function(t,e,n){"use strict";n.d(e,{ZP:function(){return f},b6:function(){return a},c1:function(){return u},w6:function(){return s}});var r=n(39824),o=n(97921),c=n(2265),i=n(63861);let s="",a="",l="";async function u(){let t=await fetch("https://api.ets2la.com/auth/discord"),e=await t.json();window.open(e,"_blank")}async function d(t){let e="https://api.ets2la.com/user/".concat(l),n=await fetch(e,{headers:{Authorization:"Bearer ".concat(s)}}),r=await n.json();return r.error||null==r.data?(s="",l="",null):(t(a=r.data.username),r)}function f(){let{setToken:t,setUsername:e}=(0,o.a)(),{data:n}=(0,i.ZP)("global",r.Yw,{refreshInterval:1e3});return(0,c.useEffect)(()=>{if(n){if(!n.token||!n.user_id){s="",l="",t("");return}s=n.token,l=n.user_id,t(s),d(e)}},[n,t,e]),null}},97921:function(t,e,n){"use strict";n.d(e,{H:function(){return s},a:function(){return a}});var r=n(57437),o=n(2265),c=n(89318);let i=(0,o.createContext)(void 0);function s(t){let{children:e}=t,[n,s]=(0,o.useState)(c.w6),[a,l]=(0,o.useState)(c.b6);return(0,r.jsx)(i.Provider,{value:{token:n,username:a,setToken:s,setUsername:l},children:e})}function a(){let t=(0,o.useContext)(i);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},39824:function(t,e,n){"use strict";n.d(e,{Or:function(){return c},Yw:function(){return o},wX:function(){return i}});var r=n(42306);async function o(t){let e=await fetch("http://".concat(r.ip,":37520/backend/plugins/").concat(t,"/settings"));return await e.json()}async function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let o=await fetch("http://".concat(r.ip,":37520/backend/plugins/").concat(t,"/settings/").concat(e));if(!o.ok)return console.error("Failed to fetch: HTTP status ".concat(o.status)),n;try{let t=await o.json();if(null===t)return n;return t}catch(t){return console.error("Failed to parse JSON response:",t),n}}catch(t){return console.error("An error occurred while getting the setting by key:",t),n}}async function i(t,e,n){try{let o=await fetch("http://".concat(r.ip,":37520/backend/plugins/").concat(t,"/settings/").concat(e,"/set"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:n})});if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));return await o.json()}catch(t){console.error("An error occurred while setting the setting by key:",t)}}},66374:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return f}});var r=n(57437),o=n(89318),c=n(39824),i=n(62869),s=n(3991),a=n(69711),l=n(2265),u=n(93772),d=n(63861);function f(){let{data:t}=(0,d.ZP)("global",c.Yw,{refreshInterval:1e3}),[e,n]=(0,l.useState)(!1);if(!t)return(0,r.jsx)("div",{className:"w-full h-full font-geist pl-28 pr-20 pt-20 flex flex-col gap-6",children:"Loading..."});let f=null==t?void 0:t.user_id,h=null==t?void 0:t.token;return f&&h&&e&&(n(!1),u.Am.success((0,s.Iu)("frontend.login.successful"),{description:(0,s.Iu)("frontend.login.successful_description")})),(0,r.jsx)("div",{className:"font-geist w-full h-full items-center flex justify-center",children:(0,r.jsxs)("div",{className:"border rounded-md p-4 bg-input/10 items-center justify-center flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("p",{className:"text-xl font-semibold",children:(0,s.Iu)("frontend.login")}),(0,r.jsx)("p",{className:"max-w-96 text-muted-foreground",children:(0,s.Iu)("frontend.login.disclaimer")})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 w-96",children:[(0,r.jsxs)(i.z,{className:"max-w-96",variant:"outline",onClick:()=>{(0,o.c1)(),n(!0)},children:[(0,s.Iu)("frontend.login.discord")," ",e&&(0,r.jsx)(a.Z,{className:"ml-2"})]}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"max-w-96 text-muted-foreground text-xs cursor-pointer",onClick:()=>{window.open("https://ets2la.github.io/documentation/privacy-policy/#the-information-we-store","_blank")},children:(0,s.Iu)("frontend.login.privacy_policy")})})]}),f&&h&&(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("p",{className:"text-muted-foreground max-w-96",children:(0,s.Iu)("frontend.login.already_logged_in")}),(0,r.jsx)("p",{className:"text-muted-foreground max-w-96",children:"User ID: ".concat(f)})]})]})})}}},function(t){t.O(0,[569,861,438,284,971,117,744],function(){return t(t.s=34226)}),_N_E=t.O()}]);